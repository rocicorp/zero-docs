---
title: Zero 0.24
description: Join Flipping, Previews, Cookie Auth
---

## Install

```bash
npm install @rocicorp/zero@0.24
```

## About

This release adds [*join flipping*](/docs/reading-data#join-flipping), a way to hint to ZQL the order joins should happen in. This is a major benefit for queries that use `whereExists()`. Since almost all Zero applications use `whereExists()` to implement features like permissions and label filters, this should improve performance for most applications.

There are also several other major new features and many bug fixes.

## Upgrading

1. If you are using the `push.url` param to the `Zero` constructor, rename it to `mutateURL`.
2. If you are using the `ZERO_PUSH_URL` config param, rename it to `ZERO_MUTATE_URL`.
3. If you are awaiting queries directly without calling `run()`, like `await z.query.foo.where(...)`, or `await tx.query.foo.where(...)`, add `.run()` to the end, like `await z.query.foo.where(...).run()` or `await tx.query.foo.where(...).run()`. This is most common in custom mutator implementations.
4. Add a `ZERO_ADMIN_PASSWORD` env var to your production config. This is now required.

See [Breaking Changes](#breaking-changes) for details on each of these.

Finally, learn about [join flipping](/docs/reading-data#join-flipping) and consider each of your `whereExists()` queries to see if you can improve performance by applying it.

See the [ztunes](TODO) and [zslack](TODO) updates for examples of updating to 0.24.

## Features

- [Dramatically faster `whereExists()` with join flipping](/docs/reading-data#join-flipping)
- [Support for `op-sqlite` in React Native](/docs/react-native#op-sqlite)
- [Preview support for custom mutators](/docs/custom-mutators#custom-mutate-url) and [synced queries](/docs/synced-queries#custom-get-queries-url)
- [Added `analyze()` to the inspector and various other improvements](/docs/debug/inspector#analyzing-queries)
- [Improved server ZQL APIs, added `node-postgres` and Drizzle support](/docs/zql-on-the-server)
- [Added `QueryResultType` and `QueryRowType` helpers](/docs/reading-data#type-helpers)
- [Added support for opaque](/docs/auth#opaque-auth-tokens) and [cookie-based auth](/docs/auth#cookie-based-auth)
- [Expose server errors from get-queries endpoint to client](/docs/synced-queries#handling-errors)
- [New `hello-zero-cf` sample that runs entirely inside Cloudflare Workers](/docs/samples#hello-zero-cf)

## Fixes

- [Correctly map primary keys to server names in some edge cases](https://github.com/rocicorp/mono/pull/4857)
- [Reduce some OTEL error logging to `warn`](https://github.com/rocicorp/mono/pull/4867)
- [Fix a case of deadlock related to CVR cleanup](https://github.com/rocicorp/mono/pull/4877)
- [Fix hang on shutdown under Bun CLI](https://github.com/rocicorp/mono/pull/4854) (thanks [David](https://github.com/dpeek)!)
- [Fix "View already exists" error](https://github.com/rocicorp/mono/pull/4888), [Discord](https://discord.com/channels/830183651022471199/1415395645203812424/1415395649205305434)
- [Fix rows sometimes missing from `startAt` queries](https://github.com/rocicorp/mono/pull/4926)
- [Improve performance of CVR cleanup](https://github.com/rocicorp/mono/pull/4930)
- [Disable statement-level timeouts that were preventing CVR cleanup](https://github.com/rocicorp/mono/pull/4933)
- [Fix WAL growth when no connected clients](https://github.com/rocicorp/mono/pull/4954)
- [Fix exception with local-only queries and `enableLegacyQueries:false`](https://github.com/rocicorp/mono/pull/4967)
- [Fix inability to use `--flags` with `zero-cache-dev`](https://github.com/rocicorp/mono/pull/4966) (thanks [Alizain](https://github.com/alizain)!).
- [Reduce ping timeouts during slow queries with better time-slicing](https://github.com/rocicorp/mono/pull/4989)
- [Improve handling of ownership changes in the change-streamer](https://github.com/rocicorp/mono/pull/4994)

## Breaking Changes

- [The `ZERO_ADMIN_PASSWORD` config param is now required in production](/docs/zero-cache-config#admin-password)
- [`push.url`/`ZERO_PUSH_URL` were renamed to `mutateURL`/`ZERO_MUTATE_URL`](/docs/custom-mutators#custom-mutate-url)
- [Queries are no longer thenable â€“ any place you were using `await tx.query.foo` needs to change to `await tx.query.foo.run()`](/docs/reading-data#default-run)
