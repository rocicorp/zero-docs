---
title: CRUD
description: Low-Level Write API
---

With a [mutator](mutators), Zero provides a CRUD-style API to insert, update, and delete rows.

## Create a Builder

To get started, use `createCRUDBuilder()`.

If you use `drizzle-zero` or `prisma-zero`, this happens automatically and an instance is stored in the `crud` constant exported from `schema.ts`:

```ts
import {crud} from 'schema.ts'

// crud is ready to use!
crud.myTable.insert({ ... })
```

Otherwise, create an instance manually:

```ts
// schema.ts
// ...
export const crud = createCRUDBuilder(schema)
```

## Insert

Create new records with `insert`:

```tsx
tx.mutate(
  crud.user.insert({
    id: nanoid(),
    username: 'sam',
    language: 'js'
  })
)
```

Optional fields can be set to `null` to explicitly set the new field to `null`. They can also be set to `undefined` to take the default value (which is often `null` but can also be some generated value server-side):

```tsx
// schema.ts
import {createTableSchema} from '@rocicorp/zero'

const userSchema = createTableSchema({
  tableName: 'user',
  columns: {
    id: {type: 'string'},
    name: {type: 'string'},
    language: {type: 'string', optional: true}
  },
  primaryKey: ['id'],
  relationships: {}
})

// app.tsx

// Sets language to `null` specifically
tx.mutate(
  crud.user.insert({
    id: nanoid(),
    username: 'sam',
    language: null
  })
)

// Sets language to the default server-side value. Could be null, or some
// generated or constant default value too.
tx.mutate(
  crud.user.insert({
    id: nanoid(),
    username: 'sam'
  })
)

// Same as above
tx.mutate(
  crud.user.insert({
    id: nanoid(),
    username: 'sam',
    language: undefined
  })
)
```

## Upsert

Create new records or update existing ones with `upsert`:

```tsx
tx.mutate(
  crud.user.upsert({
    id: samID,
    username: 'sam',
    language: 'ts'
  })
)
```

`upsert` supports the same `null` / `undefined` semantics for optional fields that `insert` does (see above).

## Update

Update an existing record. Does nothing if the specified record (by PK) does not exist.

You can pass a partial, leaving fields out that you donâ€™t want to change. For example here we leave the username the same:

```tsx
// Leaves username field to previous value.
tx.mutate(
  crud.user.update({
    id: samID,
    language: 'golang'
  })
)

// Same as above
tx.mutate(
  crud.user.update({
    id: samID,
    username: undefined,
    language: 'haskell'
  })
)
// Reset language field to `null`
tx.mutate(
  crud.user.update({
    id: samID,
    language: null
  })
)
```

## Delete

Delete an existing record. Does nothing if specified record does not exist.

```tsx
tx.mutate(
  crud.user.delete({
    id: samID
  })
)
```
