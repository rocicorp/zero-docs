---
title: Zero 0.24
description: Join Flipping, Cookie Auth, Previews
---

## About

This release adds [*join flipping*](/docs/reading-data#join-flipping), a way to hint to ZQL the order joins should happen in. This is a major benefit for queries that use `whereExists()`. Since almost all Zero applications use `whereExists()` to implement features like permissions and label filters, this should improve performance for most applications.

There are also several other major new features and many bug fixes.

## Installation

```bash
npm install @rocicorp/zero@0.24
```

## Breaking Changes

1. If you are using the `push.url` param to the `Zero` constructor, rename it to `mutateURL` ([more info](/docs/custom-mutators#custom-mutate-url)).
2. If you are using the `ZERO_PUSH_URL` config param, rename it to `ZERO_MUTATE_URL` ([more info](/docs/custom-mutators#custom-mutate-url)).
3. If you are awaiting queries directly without calling `run()`, like `await z.query.foo.where(...)`, or `await tx.query.foo.where(...)`, add `.run()` to the end, like `await z.query.foo.where(...).run()` or `await tx.query.foo.where(...).run()`.. This is most common in custom mutator implementations ([more info](/docs/reading-data#default-run))
4. If you are building for React Native, change your import path from `@rocicorp/zero/react-native` to `@rocicorp/zero/expo-sqlite` ([more&nbsp;info](/docs/react-native))
5. Add a `ZERO_ADMIN_PASSWORD` env var to your production config. This is now required ([more info](/docs/zero-cache-config#admin-password))

## Example Upgrades

* [ztunes](https://github.com/rocicorp/ztunes/pull/23)
* [zslack](https://github.com/rocicorp/zslack/pull/12)
* [hello-zero-solid](https://github.com/rocicorp/hello-zero-solid/pull/27)
* [hello-zero](https://github.com/rocicorp/hello-zero/pull/50) â€“ Note that we are keeping `hello-zero` on the legacy query and mutator APIs until they are deprecated, for testing reasons. So this PR doesn't include custom mutator, synced query, or auth-related changes.

## Features

- [Dramatically faster `whereExists()` with join flipping](/docs/reading-data#join-flipping)
- [Much simpler auth with cookies](/docs/auth#cookie-based-auth) or [opaque tokens](/docs/auth#opaque-auth-tokens)
- [Full support for previews via custom mutators](/docs/custom-mutators#custom-mutate-url) and [synced queries](/docs/synced-queries#custom-get-queries-url)
- [Analyze queries directly from inspector](/docs/debug/inspector#analyzing-queries), and [simplified metrics output](/docs/debug/inspector#queries)
- [New `QueryResultType` and `QueryRowType` helpers](/docs/reading-data#type-helpers)
- [Improved server ZQL APIs, added `node-postgres` and Drizzle support](/docs/zql-on-the-server)
- [Faster SQLite bindings for React Native via `op-sqlite`](/docs/react-native#op-sqlite)
- [Expose server errors from get-queries endpoint to client](/docs/synced-queries#handling-errors)
- [New first-class Cloudflare Workers sample](/docs/samples#hello-zero-cf)

## Fixes

- [Correctly map primary keys to server names in some edge cases](https://github.com/rocicorp/mono/pull/4857)
- [Reduce some OTEL error logging to `warn`](https://github.com/rocicorp/mono/pull/4867)
- [Fix a case of deadlock related to CVR cleanup](https://github.com/rocicorp/mono/pull/4877)
- [Fix hang on shutdown under Bun CLI](https://github.com/rocicorp/mono/pull/4854) (thanks [David](https://github.com/dpeek)!)
- [Fix "View already exists" error](https://github.com/rocicorp/mono/pull/4888), [Discord](https://discord.com/channels/830183651022471199/1415395645203812424/1415395649205305434)
- [Fix rows sometimes missing from `startAt` queries](https://github.com/rocicorp/mono/pull/4926)
- [Improve performance of CVR cleanup](https://github.com/rocicorp/mono/pull/4930)
- [Disable statement-level timeouts that were preventing CVR cleanup](https://github.com/rocicorp/mono/pull/4933)
- [Fix WAL growth when no connected clients](https://github.com/rocicorp/mono/pull/4954)
- [Fix exception with local-only queries and `enableLegacyQueries:false`](https://github.com/rocicorp/mono/pull/4967)
- [Fix inability to use `--flags` with `zero-cache-dev`](https://github.com/rocicorp/mono/pull/4966) (thanks [Alizain](https://github.com/alizain)!).
- [Reduce ping timeouts during slow queries with better time-slicing](https://github.com/rocicorp/mono/pull/4989)
- [Improve handling of ownership changes in the change-streamer](https://github.com/rocicorp/mono/pull/4994)
